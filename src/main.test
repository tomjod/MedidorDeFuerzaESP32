#include <Arduino.h>
#include <HX711_ADC.h>

// Usa los pines del sensor que estamos probando
const int PIN_DAT = 19;
const int PIN_CLK = 5;

// Crea un solo objeto sensor
HX711_ADC sensorPrueba(PIN_DAT, PIN_CLK);

void setup() {
  Serial.begin(115200);
  Serial.println("--- Prueba de Sensor de Carga ---");
  Serial.println("Iniciando sensor...");

  sensorPrueba.begin();
  sensorPrueba.setGain(128); // Ganancia estándar

  // Hacemos una tara (puesta a cero) al inicio
  // El 'true' significa que taramos
  sensorPrueba.start(2000, true); 
  if (sensorPrueba.getTareTimeoutFlag()) {
    Serial.println("Error de Timeout en Tara. Revisa conexiones.");
  } else {
    Serial.println("Sensor tarado y listo.");
  }

  // IMPORTANTE: Usamos factor de calibración 1.0
  // Queremos ver los valores "crudos" (raw), no Kg.
  sensorPrueba.setCalFactor(1.0); 

  Serial.println("Presiona o estira la celda con tu mano...");
}

void loop() {
  // 1. Actualiza el sensor (no bloqueante)
  sensorPrueba.update();

  // 2. Obtiene el dato crudo
  float lectura = sensorPrueba.getData();

  // 3. Muestra el dato en el Monitor Serial
  Serial.print("Lectura cruda: ");
  Serial.println(lectura);

  delay(100); // Pequeña pausa para no saturar el monitor
}